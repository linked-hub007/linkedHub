{% load static %}
{% load i18n %}
{% load account %}
{% load allauth %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        {% block head_title %}
            {% trans "Confirm Email Address" %}
        {% endblock head_title %}
    </title>
    <link rel="stylesheet" href="{% static 'css/password_reset.css' %}">
    <link rel="icon" type="image/png" href="{% static 'images/aim.png' %}">
</head>
<body>
    {% block content %}
    <div class="container">
        <div class="card">
            {% if confirmation %}
                {% if can_confirm %}
                    <div class="success-icon">✓</div>
                {% else %}
                    <div class="success-icon">⚠️</div>
                {% endif %}
            {% else %}
                <div class="success-icon">⚠️</div>
            {% endif %}
            
            {% element h1 %}
                {% trans "Confirm Email Address" %}
            {% endelement %}
            
            {% if confirmation %}
                {% user_display confirmation.email_address.user as user_display %}
                {% if can_confirm %}
                    {% element p %}
                        <div class="message-text">
                            {% blocktrans with confirmation.email_address.email as email %}Please confirm that <a href="mailto:{{ email }}">{{ email }}</a> is an email address for user {{ user_display }}.{% endblocktrans %}
                        </div>
                    {% endelement %}
                    
                    {% url 'account_confirm_email' confirmation.key as action_url %}
                    {% element form method="post" action=action_url %}
                        <div class="form-group">
                            {% slot actions %}
                                {% csrf_token %}
                                {{ redirect_field }}
                                {% element button type="submit" %}
                                    <button type="submit" class="reset-btn">
                                        {% trans 'Confirm' %}
                                    </button>
                                {% endelement %}
                            {% endslot %}
                        </div>
                    {% endelement %}
                {% else %}
                    {% element p %}
                        <div class="info-text">
                            {% blocktrans %}Unable to confirm {{ email }} because it is already confirmed by a different account.{% endblocktrans %}
                        </div>
                    {% endelement %}
                {% endif %}
            {% else %}
                {% url 'account_email' as email_url %}
                {% element p %}
                    <div class="info-text">
                        {% blocktrans %}This email confirmation link expired or is invalid. Please <a href="{{ email_url }}">issue a new email confirmation request</a>.{% endblocktrans %}
                    </div>
                {% endelement %}
            {% endif %}
        </div>
    </div>
    
    <footer class="footer">
        <p>&copy; <span id="displayYear"></span> All rights reserved linkedHub.</p>
    </footer>
    {% endblock content %}

    <script>
        // Set current year in footer
        document.addEventListener('DOMContentLoaded', function() {
            const displayYear = document.getElementById('displayYear');
            if (displayYear) {
                displayYear.textContent = new Date().getFullYear();
            }
        });
    </script>
</body>
</html>