{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>{{user.username }} - Profile</title>
    <link rel="icon" type="image/png" href="{% static 'images/aim.ico' %}">
    <link href="{% static 'css/profile.css' %}" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.css' %}" />
    <link href="{% static 'css/style.css' %}" rel="stylesheet" />
    <link href="{% static 'css/responsive.css' %}" rel="stylesheet" />
    
</head>

<body>
    <!-- Navigation Bar -->
    <header class="header_section">
      <div class="container-fluid">
        <nav class="navbar navbar-expand-lg custom_nav-container pt-3">
          <a class="navbar-brand" href="{% url 'home' %}">
            <img src="{% static 'images/logo.png' %}" alt="" />
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <div class="d-flex ml-auto flex-column flex-lg-row align-items-center">
              <ul class="navbar-nav  ">
                <li class="nav-item ">
                  <a class="nav-link" href="{% url 'base' %}">Home </a>
                </li>
                <li class="nav-item ">
                  <a class="nav-link" href="{% url 'about' %}">About</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'user_directory' %}">Members</a>
                </li>
                
                {% if is_owner %}
                <a href="{% url 'account_settings' %}" class="btn btn-outline-light me-2">
                    <i class="fas fa-cog"></i>
                    Settings
                    <span class="sr-only">(current)</span>
                </a>
                {% endif %}
            </ul>
            </div>
          </div>
        </nav>
      </div>
    </header>
    

    <!-- Profile Header -->
    <div class="profile-header">
        <div class="banner-container">
            {% if profile.banner_image %}
            <img src="{{ profile.banner_image.url }}" class="banner-image" alt="Banner Image">
            {% else %}
            <div class="banner-placeholder"></div>
            {% endif %}
        </div>
        <!-- Fixed Alert Messages - No slider effect -->
                {% if messages %}
                    <div class="alert-container">
                        {% for message in messages %}
                            <div class="alert alert-{{ message.tags }}" role="alert">
                                {{ message }}
                                <button type="button" class="btn-close" onclick="this.parentElement.style.display='none'" aria-label="Close">&times;</button>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
        <!-- Fixed Alert Messages - No slider effect -->

        
        <div class="profile-info-container">
            <div class="profile-picture-container">
                <div class="profile-picture">
                    {% if profile.profile_picture %}
                        <img src="{{ profile.profile_picture.url }}" alt="Profile Picture">
                    {% else %}
                        <i class="fas fa-user"></i>
                    {% endif %}
                </div>
            </div>
            
            <div class="profile-details">
                <h1>{{ user.get_full_name|default:user.username }}
                <i class="fas fa-bolt verified-icon"></i>
                </h1>
                <p class="username">@{{ user.username }}</p>
                
                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="stat-number">{{ profile.views }}</span>
                        <span class="stat-label">Views</span>
                    </div>
                </div>
                
                {% if profile.bio %}
                <div class="profile-bio">
                    <p>{{ profile.bio }}</p>
                </div>
                {% endif %}
                
            </div>
        </div>
    </div>
    <!-- Profile Navigation -->
    <div class="profile-navigation">
        <div class="container-fluid">
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" href="#"><i class="fas fa-user me-1"></i> About</a>
                </li>
                {% if is_owner %} 
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'post' %}"><i class="fas fa-clone me-1"></i> Post</a>  
                </li>
                 {% endif %}
                {% if is_owner %} 
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'my_tasks' %}"><i class="fas fa-file-alt me-1"></i>Uploads</a>
                </li>
                {% endif %}
                {% if is_owner %} 
                <li class="nav-item position-relative">
                    <a class="nav-link" href="{% url 'my_task_applications' %}">
                        <i class="fas fa-handshake me-1"></i>Request 
                    </a>
                </li>
                {% endif %}
            </ul>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="content-container">
            <!-- Row 1: About and Social Links -->
            <div class="content-row">
                <!-- About Section -->
                <div class="card about-section">
                    <div class="card-header">
                        <h3><i class="fas fa-info-circle me-2"></i>About</h3>
                    </div>
                    <div class="card-body">
                        <div class="about-grid">
                            {% if profile.location %}
                            <div class="about-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <div>
                                    <h5>Location</h5>
                                    <p>{{ profile.location }}</p>
                                </div>
                            </div>
                            {% endif %}
                            
                            {% if user.email %}
                            <div class="about-item">
                                <i class="fas fa-envelope"></i>
                                <div>
                                    <h5>Email</h5>
                                    <p>{{ user.email }}</p>
                                </div>
                            </div>
                            {% endif %}
                            
                            {% if profile.phone %}
                            <div class="about-item">
                                <i class="fas fa-phone"></i>
                                <div>
                                    <h5>Phone</h5>
                                    <p>{{ profile.phone }}</p>
                                </div>
                            </div>
                            {% endif %}
                            
                            {% if profile.website %}
                            <div class="about-item">
                                <i class="fas fa-globe"></i>
                                <div>
                                    <h5>Website</h5>
                                    <a href="{{ profile.website }}" target="_blank">{{ profile.website }}</a>
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Social Links -->
                <div class="card social-links-section">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3><i class="fas fa-share-alt me-2"></i>Social Links</h3>
                        {% if is_owner %}
                        <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addLinkModal">
                            <i class="fas fa-plus me-1"></i> Add
                        </button>
                        {% endif %}
                    </div>
                    <div class="card-body">
                        {% if social_links %}
                            <div class="social-links-grid">
                                {% for link in social_links %}
                                <div class="social-link-item">
                                    <div class="social-link-icon">
                                        <i class="{{ link.icon_class }}"></i>
                                    </div>
                                    <div class="social-link-info">
                                        <a href="{{ link.url }}" target="_blank" class="social-link-url">{{ link.username }}</a>
                                    </div>
                                    {% if is_owner %}
                                    <div class="social-link-actions">
                                        <form method="post" action="{% url 'delete_social_link' link.id %}">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Are you sure you want to delete this link?')">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </form>
                                    </div>
                                    {% endif %}
                                </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="empty-section">
                                <i class="fas fa-share-alt"></i>
                                <h4>No social links added</h4>
                                {% if is_owner %}
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addLinkModal">
                                    <i class="fas fa-plus me-2"></i> Add Social Link
                                </button>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Education Section -->
                <div class="card education-section">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3><i class="fas fa-graduation-cap me-2"></i>Education</h3>
                        {% if is_owner %}
                        <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addEducationModal">
                            <i class="fas fa-plus me-1"></i> Add
                        </button>
                        {% endif %}
                    </div>
                    <div class="card-body">
                        {% if educations %}
                            {% for education in educations %}
                            <div class="education-item">
                                <div class="education-header">
                                    <div class="education-icon">
                                        <i class="fas fa-university"></i>
                                    </div>
                                    <div class="education-title">
                                        <h4>{{ education.institution }}</h4>
                                        <p class="degree">{{ education.degree }}{% if education.field_of_study %} in {{ education.field_of_study }}{% endif %}</p>
                                        <p class="date">
                                            {{ education.start_date|date:"Y" }} - 
                                            {% if education.end_date %}{{ education.end_date|date:"Y" }}{% else %}Present{% endif %}
                                        </p>
                                    </div>
                                    {% if is_owner %}
                                    <div class="education-actions">
                                        <form method="post" action="{% url 'delete_education' education.id %}" class="d-inline">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-sm btn-outline-danger ms-1" onclick="return confirm('Are you sure you want to delete this education entry?')">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </form>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-section">
                                <i class="fas fa-graduation-cap"></i>
                                <h4>No education added yet</h4>
                                {% if is_owner %}
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addEducationModal">
                                    <i class="fas fa-plus me-2"></i> Add Education
                                </button>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Row 2: Documents/Certificates (Full Width) -->
            <div class="content-row">
                <div class="card documents-section">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h3><i class="fas fa-file-alt me-2"></i>Documents & Certificates</h3>
                        {% if is_owner %}
                        <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#uploadDocumentModal">
                            <i class="fas fa-plus me-1"></i> Add
                        </button>
                        {% endif %}
                    </div>
                    <div class="card-body">
                        {% if documents %}
                            <div class="documents-grid">
                                {% for document in documents %}
                                <div class="document-item">
                                    <div class="document-icon">
                                        <i class="fas fa-file-pdf"></i>
                                    </div>
                                    <div class="document-info">
                                        <h5>{{ document.title }}</h5>
                                        <p class="document-type">{{ document.get_document_type_display }}</p>
                                        {% if document.description %}
                                        <p class="document-description">{{ document.description }}</p>
                                        {% endif %}
                                    </div>
                                    <div class="document-actions">
                                        <a href="{{ document.file.url }}" class="btn btn-sm btn-outline-primary" target="_blank">
                                            <i class="fas fa-eye"></i> View
                                        </a>
                                        {% if is_owner %}
                                        <form method="post" action="{% url 'delete_document' document.id %}" class="d-inline">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-sm btn-outline-danger ms-1" onclick="return confirm('Are you sure you want to delete this document?')">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </form>
                                        {% endif %}
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="empty-section">
                                <i class="fas fa-file-alt"></i>
                                <h4>No documents uploaded yet</h4>
                                {% if is_owner %}
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#uploadDocumentModal">
                                    <i class="fas fa-upload me-2"></i> Upload Document
                                </button>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container-fluid">
            <p>&copy; <span id="displayYear"></span> All rights reserved LinkedHub</p>
        </div>
    </footer>

    <!-- All your existing modals here -->
    <!-- Add Education Modal -->
    <div class="modal fade" id="addEducationModal" tabindex="-1" aria-labelledby="addEducationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="addEducationModalLabel">Add Education</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form method="post" action="{% url 'add_education' %}">
                    <div class="modal-body">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="institution" class="form-label">Institution</label>
                            <input type="text" class="form-control" id="institution" name="institution" required placeholder="University/School name">
                        </div>
                        <div class="mb-3">
                            <label for="degree" class="form-label">Degree</label>
                            <input type="text" class="form-control" id="degree" name="degree" required placeholder="e.g., Bachelor of Science">
                        </div>
                        <div class="mb-3">
                            <label for="field_of_study" class="form-label">Field of Study</label>
                            <input type="text" class="form-control" id="field_of_study" name="field_of_study" placeholder="e.g., Computer Science">
                        </div>
                        <div class="mb-3">
                            <label for="start_date" class="form-label">Start Date</label>
                            <input type="date" class="form-control" id="start_date" name="start_date" required>
                        </div>
                        <div class="mb-3">
                            <label for="end_date" class="form-label">End Date</label>
                            <input type="date" class="form-control" id="end_date" name="end_date">
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="currently_studying" name="currently_studying">
                            <label class="form-check-label" for="currently_studying">Currently studying here</label>
                        </div>
                        <div class="mb-3">
                            <label for="description" class="form-label">Description</label>
                            <textarea class="form-control" id="description" name="description" rows="3" placeholder="Additional details about your education"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add Education</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Add Social Link Modal -->
    <div class="modal fade" id="addLinkModal" tabindex="-1" aria-labelledby="addLinkModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="addLinkModalLabel">Add Social Link</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form method="post" action="{% url 'add_social_link' %}">
                    <div class="modal-body">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="platform" class="form-label">Platform</label>
                            <select class="form-select" id="platform" name="platform" required>
                                <option value="">Select platform</option>
                                <option value="linkedin">LinkedIn</option>
                                <option value="twitter">Twitter</option>
                                <option value="facebook">Facebook</option>
                                <option value="instagram">Instagram</option>
                                <option value="github">GitHub</option>
                                <option value="youtube">YouTube</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="social_username" class="form-label">Username/Handle</label>
                            <input type="text" class="form-control" id="social_username" name="username" required placeholder="Your username on this platform">
                        </div>
                        <div class="mb-3">
                            <label for="social_url" class="form-label">Profile URL</label>
                            <input type="url" class="form-control" id="social_url" name="url" required placeholder="https://example.com/yourprofile">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Add Social Link</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Upload Document Modal -->
    <div class="modal fade" id="uploadDocumentModal" tabindex="-1" aria-labelledby="uploadDocumentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="uploadDocumentModalLabel">Upload Document</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form method="post" action="{% url 'upload_document' %}" enctype="multipart/form-data">
                    <div class="modal-body">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="document_title" class="form-label">Document Title</label>
                            <input type="text" class="form-control" id="document_title" name="title" required placeholder="Enter document title">
                        </div>
                        <div class="mb-3">
                            <label for="document_type" class="form-label">Document Type</label>
                            <select class="form-select" id="document_type" name="document_type" required>
                                <option value="">Select document type</option>
                                <option value="certificate">Certificate</option>
                                <option value="diploma">Diploma</option>
                                <option value="transcript">Transcript</option>
                                <option value="resume">Resume</option>
                                <option value="portfolio">Portfolio</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="document_file" class="form-label">Document File</label>
                            <input type="file" class="form-control" id="document_file" name="file" required accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                            <div class="form-text">Supported formats: PDF, DOC, DOCX, JPG, PNG (Max 10MB)</div>
                        </div>
                        <div class="mb-3">
                            <label for="document_description" class="form-label">Description</label>
                            <textarea class="form-control" id="document_description" name="description" rows="3" placeholder="Brief description of the document"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Upload Document</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Upload Doc Modal -->
     <div class="modal fade" id="uploadDocumentModal" tabindex="-1" aria-labelledby="uploadDocumentModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="uploadDocumentModalLabel">Upload Document</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form method="post" action="{% url 'upload_document' %}" enctype="multipart/form-data">
                    <div class="modal-body">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="document_title" class="form-label">Document Title</label>
                            <input type="text" class="form-control" id="document_title" name="title" required placeholder="Enter document title">
                        </div>
                        <div class="mb-3">
                            <label for="document_type" class="form-label">Document Type</label>
                            <select class="form-select" id="document_type" name="document_type" required>
                                <option value="">Select document type</option>
                                <option value="certificate">Certificate</option>
                                <option value="diploma">Diploma</option>
                                <option value="transcript">Transcript</option>
                                <option value="resume">Resume</option>
                                <option value="portfolio">Portfolio</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="document_file" class="form-label">Document File</label>
                            <input type="file" class="form-control" id="document_file" name="file" required accept=".pdf,.doc,.docx,.jpg,.jpeg,.png">
                            <div class="form-text">Supported formats: PDF, DOC, DOCX, JPG, PNG (Max 10MB)</div>
                        </div>
                        <div class="mb-3">
                            <label for="document_description" class="form-label">Description</label>
                            <textarea class="form-control" id="document_description" name="description" rows="3" placeholder="Brief description of the document"></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Upload Document</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Upload End-doc Modal -->
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="{% static 'js/custom.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
   <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" 
          integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" 
          crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="{% static 'js/displayYear.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/profile.js' %}"></script>
    
</body>
</html>